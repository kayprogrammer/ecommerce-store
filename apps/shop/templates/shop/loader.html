<div id="backdrop" class="backdrop" style="display: none;">
    <div id="loader" class="loader">Loading...</div>
</div>

<style>
    .backdrop {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
    }

    .loader {
        border: 16px solid #f3f3f3;
        border-radius: 50%;
        border-top: 16px solid #3498db;
        width: 120px;
        height: 120px;
        animation: spin 2s linear infinite;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
</style>

<script>
    document.body.addEventListener('htmx:configRequest', function(evt) {
        // Check if the request is not a wishlist toggle request
        if (!event.detail.elt.hasAttribute('data-wishlist-toggle')) {
            document.getElementById('backdrop').style.display = 'flex';
        }
    });

    document.body.addEventListener('htmx:afterRequest', function(evt) {
        document.getElementById('backdrop').style.display = 'none';
    });
</script>